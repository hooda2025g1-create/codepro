<!DOCTYPE html>
<html dir="rtl" lang="ar">
<head>
    <meta charset="UTF-8">
    <title>إنشاء حساب جديد - مشغل JavaScript</title>
    <link rel="stylesheet" href="style.css"> <!-- نستخدم نفس التصميم -->
    <style>
        /* إضافة تنسيقات خاصة بصفحة التسجيل */
        .register-container { max-width: 500px; margin: 50px auto; padding: 30px; }
        .form-group { margin-bottom: 20px; }
        .error-message { color: #ef4444; font-size: 0.9em; margin-top: 5px; display: none; }
        .warning { background-color: #fff7ed; border-right: 4px solid #f59e0b; padding: 10px; margin: 15px 0; }
    </style>
</head>
<body>
    <div class="register-container">
        <h1><i class="fas fa-user-plus"></i> إنشاء حساب جديد</h1>
        
        <form id="registerForm">
            <!-- حقل الاسم الرباعي -->
            <div class="form-group">
                <label for="fullName">الاسم الرباعي الكامل *</label>
                <input type="text" id="fullName" required placeholder="أحمد محمد علي حسين">
                <div class="error-message" id="nameError">الاسم يجب أن يتكون من أربعة أجزاء على الأقل.</div>
            </div>
            
            <!-- حقل رقم الجوال -->
            <div class="form-group">
                <label for="phone">رقم الجوال (واتساب متاح) *</label>
                <input type="tel" id="phone" required placeholder="مثال: 201234567890">
                <div class="warning">
                    <i class="fas fa-exclamation-triangle"></i>
                    <strong>تنبيه:</strong> تأكد أن هذا الرقم مرتبط بتطبيق WhatsApp لاستقبال رمز التحقق.
                </div>
                <div class="error-message" id="phoneError">رقم غير صالح. تأكد من كتابة الرقم الدولي.</div>
            </div>
            
            <!-- حقل كلمة السر -->
            <div class="form-group">
                <label for="password">كلمة سر قوية *</label>
                <input type="password" id="password" required>
                <div class="error-message" id="passwordError">كلمة السر ضعيفة. يجب أن تحتوي على 8 أحرف على الأقل، وتشمل حروفاً كبيرة وصغيرة وأرقاماً.</div>
            </div>
            
            <button type="submit" class="control-btn run-btn" style="width:100%;">
                <i class="fas fa-user-check"></i> إنشاء الحساب وإرسال رمز التحقق
            </button>
            
            <p style="text-align:center; margin-top:20px;">
                لديك حساب بالفعل؟ <a href="#" onclick="alert('صفحة تسجيل الدخول قيد التطوير')">سجل دخول</a>
            </p>
        </form>
    </div>

    <script>
        // كود JavaScript للتحقق من صحة البيانات قبل الإرسال
        // (سيتم تفصيله في الخطوة التالية)
    </script>

    <script>
        document.getElementById('registerForm').addEventListener('submit', async function(event) {
    event.preventDefault(); // منع إعادة تحميل الصفحة
    
    // جمع البيانات من الحقول
    const userData = {
        name: document.getElementById('fullName').value.trim(),
        phone: document.getElementById('phone').value.trim(),
        password: document.getElementById('password').value
    };
    
    // التحقق من صحة الاسم
    if (userData.name.split(' ').length < 4) {
        document.getElementById('nameError').style.display = 'block';
        return;
    }
    
    // إرسال البيانات إلى سكريبت Google Apps Script الخاص بك
   const SUPABASE_URL = 'https://hsoeypmibkwxsuhytxcf.supabase.co';
const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imhzb2V5cG1pYmt3eHN1aHl0eGNmIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjYxNjkzMzIsImV4cCI6MjA4MTc0NTMzMn0.Y3pdXQSPHCrmI7xMwywG6ZPAm56m0H5ZHWFwGOSQ_i0';
    
    try {
        const response = await fetch(SCRIPT_URL, {
            method: 'POST',
            mode: 'no-cors', // مطلوب للتعامل مع قيود Google Apps Script
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(userData)
        });
        
        alert("تم إرسال طلب إنشاء الحساب! إذا كان الرابط صحيحاً، ستتم العملية في الخلفية.");
        // توجيه المستخدم لصفحة إدخال OTP
        // window.location.href = 'verify_otp.html?phone=' + userData.phone;
        
    } catch (error) {
        console.error('Error:', error);
        alert('حدث خطأ في الاتصال. حاول مرة أخرى.');
    }
});
    </script>
</body>
</html>